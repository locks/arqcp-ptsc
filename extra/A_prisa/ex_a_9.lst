
IGNITE Macro Assembler 1.8          ex_a_9.s        11/04/08 20:19  Page    1

   1 T                          ; Enunciado:
   2 T                          ;
   3 T                          ; A9:	Faça uma rotina que calcule o resultado
                                 da operação 3/2
   4 T                          ;
   5 T                          
   6 T                          .file "ex_a_9.s"
   7 T                          .include  "auxil.s"  
       STARTING INPUT FROM FILE: .\auxil.s
   1 T                          
   2 T                                  .file "auxil.s"   ; Ficheiro com defini
                                ‡Æo de pseudo-instru‡äes
   3 T                                                    ;  apenas "entendidas
                                " pelo emulador
   4 T                                                    ;
   5 T                                                    ; Estas instru‡äes nÆ
                                o existem no processador
   6 T                                                    ; real mas sƒo £teis 
                                no emulador.
   7 T                                                    ;
   8 T                                                    ; Usar apenas as docu
                                mentadas.
   9 T                                                    ;
  10 T                                                    ;
  11 T                                                    ; Para as usar num pr
                                ograma devemos ter a linha
  12 T                                                    ;      .include "auxi
                                l.s"
  13 T                                                    ; nesse programa, ant
                                es de as usar
  14 T                          
  15 T                                  .opt fill=0xea    ; dizer ao assemlbler
                                 para encher "os buracos"
  16 T                                                    ; com o opcode do nop
  17 T                          
  18                                    .macro prof
  19                                    .opcode 0xf8
  20                                    .endm
  21 T                          
  22                                    .macro setarg
  23                                    .opcode 0xf9
  24                                    .endm
  25 T                          
  26                                    .macro setrom
  27                                    .opcode 0xfa
  28                                    .endm
  29 T                          
  30                                    .macro keyq        ; ( -- flag )
  31                                    .opcode 0xfb       ;  Devolve 0 (zero) 
                                se nao houver nenhuma tecla
  32                                    .endm              ;  para ser lida ou 
                                -1 se existirem teclas para
  33 T                                                     ;  serem lidas
  34 T                                                     ;  keyq == key? == k
                                ey question
  35 T                          
  36                                    .macro key         ;   ( -- b )
  37                                    .opcode 0xfc       ;   Lˆ uma tecla da 
                                janela de terminal e deixa
  38                                    .endm              ;   na stack obyte c

IGNITE Macro Assembler 1.8          ex_a_9.s        11/04/08 20:19  Page    2

       SECTION: .text 
                                orrespondente
  39 T                                                     ;   ao respectivo c¢
                                digo ASCII
  40 T                          
  41 T                          
  42 T                          
  43                                    .macro emit        ;  ( b -- )
  44                                    .opcode 0xfd       ;  Imprime na janela
                                 de terminal o caracter cujo c¢digo
  45                                    .endm              ;  ASCII se encontra
                                 no topo da stack
  46 T                          
  47 T                          
  48                                    .macro halt        ;  P ra o Emulador
  49                                    .opcode 0xfe       ;
  50                                    .endm              ;
  51 T                          
       ENDING   INPUT FROM FILE: .\auxil.s
       RESUMING INPUT FROM FILE: ex_a_9.s
   8 A                          .org 0x1000      
       SECTION: ORG SECTION (ORG 00001000)
   9 A                            			
  10 A 00001000  00 00 00 02    	br inicio
  11 A                          
  12 A                          
  13 A 00001004                 ex_a_9::				; 3/2 -
                                > 3 2 /
  14 A                          
  15 A 00001004  50             	pop g0
  16 A 00001005     21          	push.n #1
  17 A 00001006        de       	divu
  18 A                          
  19 A 00001007           6e    	ret
  20 A                          
  21 A                          
  22 A 00001008                 inicio::
  23 A                          
  24 A 00001008  24             	push.n #4
  25 A 00001009     22          	push.n #2
  26 A                          
  27 A 0000100a        0f ff    	call ex_a_9
  28 A                          
  29 A                          	halt
  30 A 0000100d                 	.end

Total Errors:      0
Total Warnings:    0


SYMBOL TABLE

Value     Section/Type  Name

00003e80  ABSOLUTE      __CLOCK_KHZ__
00000001  ABSOLUTE      __IGNITE_2F__
00000065  ABSOLUTE      __PATRIOTC__
00000064  ABSOLUTE      __SEP__
00001004  ABSOLUTE      ex_a_9
00001008  ABSOLUTE      inicio
